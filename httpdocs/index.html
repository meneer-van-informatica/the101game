<!doctype html>
<html lang='en'>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no'>
<title>hello mama</title>
<style>
  :root{ --bg:#000; --fg:#fff }
  *{ box-sizing:border-box }
  html,body{ margin:0; background:var(--bg); color:var(--fg); font:16px/1.35 ui-monospace,consolas,monospace }
  #wrap{ min-height:100dvh; display:flex; flex-direction:column }
  main{ flex:1; display:grid; place-items:center; padding:24px }
  h1{ margin:0; font-size:28px; letter-spacing:.5px }
  #captions{ position:fixed; left:0; right:0; bottom:0; padding:10px 12px; text-align:center; background:rgba(0,0,0,.55); backdrop-filter:blur(2px) }
</style>
<body>
  <div id='wrap'>
    <main><h1>HELLO MAMA</h1></main>
    <footer id='universal-footer'></footer>
  </div>

  <!-- tiny srt captions (loads /specs/index.srt) -->
  <div id='captions' aria-live='polite'></div>
  <script>
    (function(){
      const box = document.getElementById('captions');
      if(!box) return;

      function parseSRT(txt){
        const cues=[], blocks = txt.replace(/\r/g,'').split(/\n\s*\n/);
        for(const b of blocks){
          const lines = b.trim().split('\n');
          if(lines.length < 2) continue;
          const m = lines[1].match(/(\d+):(\d+):(\d+),(\d+)\s*-->\s*(\d+):(\d+):(\d+),(\d+)/);
          if(!m) continue;
          const s = (+m[1])*3600+(+m[2])*60+(+m[3])+((+m[4])/1000);
          const e = (+m[5])*3600+(+m[6])*60+(+m[7])+((+m[8])/1000);
          const text = lines.slice(2).join('\n');
          cues.push({s,e,text});
        }
        return cues.sort((a,b)=>a.s-b.s);
      }

      async function load(){
        try{
          const r = await fetch('/specs/index.srt?v='+Date.now(), {cache:'no-store'});
          const txt = await r.text();
          const cues = parseSRT(txt);
          const t0 = performance.now();
          function tick(){
            const t = (performance.now()-t0)/1000;
            const c = cues.find(q => t>=q.s && t<q.e);
            box.textContent = c ? c.text : '';
            if(t < 10.25) requestAnimationFrame(tick);
          }
          tick();
        }catch(_){
          box.textContent = 'captions unavailable';
        }
      }
      (document.readyState==='loading')?document.addEventListener('DOMContentLoaded',load,{once:true}):load();
    })();
  </script>

  <!-- universal footer loader (keeps footer.spec actief) -->
  <script>
    (function(){
      const mount='universal-footer';
      function block(){ return 0; }
      function kukel(){ return 0; }
      function lang(){ return 'EN'; }
      async function load(){
        const el=document.getElementById(mount); if(!el) return;
        try{
          const r=await fetch('/specs/footer.spec?v='+Date.now(),{cache:'no-store'});
          el.innerHTML=await r.text();
        }catch(_){
          el.innerHTML='<div style="padding:12px;text-align:center;border-top:1px dashed #fff">footer unavailable</div>';
        }
        hydrate();
      }
      function q(sel){ return document.getElementById(mount)?.querySelector(sel); }
      function hydrate(){
        if(q('[data-block]')) q('[data-block]').textContent=String(block());
        if(q('[data-kukel]')) q('[data-kukel]').textContent=String(kukel());
        if(q('[data-lang]'))  q('[data-lang]').textContent =lang();
        if(q('[data-ts]'))    q('[data-ts]').textContent   =new Date().toISOString();
      }
      (document.readyState==='loading')?document.addEventListener('DOMContentLoaded',load,{once:true}):load();
    })();
  </script>
</body>
</html>
